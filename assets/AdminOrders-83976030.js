import{M as y}from"./bootstrap.esm-a46310c8.js";import{_ as D}from"./PaginationComponent-38110c9b.js";import{_ as L,c as d,d as f,w as P,b as t,F as _,q as u,f as g,t as l,v as k,H as v,e as O,a as x,o}from"./index-426ce9cf.js";import{_ as E}from"./pikachu_gif-ecacffd9.js";const{VITE_URL:p,VITE_PATH:m}={VITE_URL:"https://vue3-course-api.hexschool.io/",VITE_PATH:"wern",BASE_URL:"/PTCGTrainerWeb/",MODE:"production",DEV:!1,PROD:!0};let w="",b="";const V={data(){return{isready:!1,isLoading:!1,orders:[],pagination:{},tempOrder:{}}},methods:{createDate(n){return new Date(n*1e3).toLocaleDateString()},currency(n){return`${parseInt(n,10).toFixed(0).replace(/./g,(c,h,e)=>h&&c!=="."&&(e.length-h)%3===0?`, ${c}`.replace(/\s/g,""):c)}`},getOrders(n=1){this.$http.get(`${p}v2/api/${m}/admin/orders?page=${n}`).then(a=>{this.orders=a.data.orders,this.pagination=a.data.pagination,this.isready=!0,this.isLoading=!1})},updatePaid(n){const a={is_paid:n.is_paid};this.$http.put(`${p}v2/api/${m}/admin/order/${n.id}`,{data:a})},openModel(n,a){n==="edit"?(this.tempOrder={...a},w.show()):n==="del"&&(this.tempOrder={...a},b.show())},delOrder(){this.$http.delete(`${p}v2/api/${m}/admin/order/${this.tempOrder.id}`).then(n=>{this.tempOrder={},this.getOrders(),b.hide(),alert(n.data.message)})}},components:{Pagination:D},mounted(){this.isLoading=!0,this.getOrders(),w=new y(this.$refs.orderModal,{keyboard:!1}),b=new y(this.$refs.delOrderModal,{keyboard:!1})}},T=t("div",{class:"loadingGif"},[t("img",{src:E,alt:"會動的皮卡丘過場圖"})],-1),I={key:0,class:"container"},U={class:"table mt-4 text-white"},S=t("thead",null,[t("tr",null,[t("th",{width:"120"},"購買時間"),t("th",{width:"120"},"Email"),t("th",{width:"200"},"購買款項"),t("th",{width:"120"},"應付金額"),t("th",{width:"100"},"是否付款"),t("th",{width:"120"},"編輯")])],-1),A={class:"list-unstyled"},B={class:"form-check form-switch"},N=["onUpdate:modelValue","onChange"],R={class:"form-check-label",for:"flexSwitchCheckDefault"},q={key:0,class:"text-success"},F={key:1},H={class:"btn-group"},G=["onClick"],j=["onClick"],z={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"orderModal"},W={class:"modal-dialog modal-xl",role:"document"},J={class:"modal-content border-0"},K=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"訂單細節")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Q={class:"modal-body"},X={class:"row"},Y={class:"col-md-4"},Z=t("h3",null,"用戶資料",-1),$={class:"table"},tt={key:0},et=t("th",{style:{width:"100px"}},"姓名",-1),st=t("th",null,"Email",-1),lt=t("th",null,"電話",-1),dt=t("th",null,"地址",-1),ot={class:"col-md-8"},nt=t("h3",null,"訂單細節",-1),at={class:"table"},it=t("th",{style:{width:"100px"}},"訂單編號",-1),rt=t("th",null,"下單時間",-1),ct=t("th",null,"付款時間",-1),_t={key:0},ht={key:1},ut=t("th",null,"付款狀態",-1),pt={key:0,class:"text-success"},mt={key:1,class:"text-muted"},bt=t("th",null,"總金額",-1),yt=t("h3",null,"選購商品",-1),ft={class:"table"},gt=t("thead",null,[t("tr")],-1),kt={class:"text-end"},vt={class:"d-flex justify-content-end"},Ot={class:"form-check"},xt={class:"form-check-label",for:"flexCheckDefault"},wt={key:0},Mt={key:1},Ct=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),t("button",{type:"button",class:"btn btn-primary"},"修改付款狀態")],-1),Dt={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Lt={class:"modal-dialog"},Pt={class:"modal-content border-0"},Et=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除訂單")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Vt={class:"modal-body"},Tt={class:"text-danger"},It={class:"modal-footer"},Ut=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function St(n,a,c,h,e,i){const M=x("LoadingItem"),C=x("Pagination");return o(),d(_,null,[f(M,{active:e.isLoading,"z-index":1060,opacity:0},{default:P(()=>[T]),_:1},8,["active"]),e.isready?(o(),d("div",I,[t("table",U,[S,t("tbody",null,[(o(!0),d(_,null,u(e.orders,s=>(o(),d("tr",{key:s.id},[t("td",null,l(i.createDate(s.create_at)),1),t("td",null,l(s.user.email),1),t("td",null,[t("ul",A,[(o(!0),d(_,null,u(s.products,r=>(o(),d("li",{key:r.id},l(r.product.title)+" 數量 : "+l(r.qty)+l(r.product.unit),1))),128))])]),t("td",null,l(s.total),1),t("td",null,[t("div",B,[k(t("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault","onUpdate:modelValue":r=>s.is_paid=r,onChange:r=>i.updatePaid(s)},null,40,N),[[v,s.is_paid]]),t("label",R,[s.is_paid===!0?(o(),d("span",q,"已付款")):(o(),d("span",F,"未付款"))])])]),t("td",null,[t("div",H,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:r=>i.openModel("edit",s)}," 檢視 ",8,G),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:r=>i.openModel("del",s)}," 刪除 ",8,j)])])]))),128))])]),f(C,{pages:e.pagination,onEmitPages:i.getOrders},null,8,["pages","onEmitPages"])])):g("",!0),t("div",z,[t("div",W,[t("div",J,[K,t("div",Q,[t("div",X,[t("div",Y,[Z,t("table",$,[e.tempOrder.user?(o(),d("tbody",tt,[t("tr",null,[et,t("td",null,l(e.tempOrder.user.name),1)]),t("tr",null,[st,t("td",null,l(e.tempOrder.user.email),1)]),t("tr",null,[lt,t("td",null,l(e.tempOrder.user.tel),1)]),t("tr",null,[dt,t("td",null,l(e.tempOrder.user.address),1)])])):g("",!0)])]),t("div",ot,[nt,t("table",at,[t("tbody",null,[t("tr",null,[it,t("td",null,l(e.tempOrder.id),1)]),t("tr",null,[rt,t("td",null,l(i.createDate(e.tempOrder.create_at)),1)]),t("tr",null,[ct,t("td",null,[e.tempOrder.paid_date?(o(),d("span",_t,l(i.createDate(e.tempOrder.paid_date)),1)):(o(),d("span",ht,"時間不正確"))])]),t("tr",null,[ut,t("td",null,[e.tempOrder.is_paid?(o(),d("strong",pt,"已付款")):(o(),d("span",mt,"尚未付款"))])]),t("tr",null,[bt,t("td",null,l(i.currency(e.tempOrder.total)),1)])])]),yt,t("table",ft,[gt,t("tbody",null,[(o(!0),d(_,null,u(e.tempOrder.products,s=>(o(),d("tr",{key:s.id},[t("th",null,l(s.product.title),1),t("td",null,l(s.qty)+" / "+l(s.product.unit),1),t("td",kt,l(i.currency(s.final_total)),1)]))),128))])]),t("div",vt,[t("div",Ot,[k(t("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":a[0]||(a[0]=s=>e.tempOrder.is_paid=s)},null,512),[[v,e.tempOrder.is_paid]]),t("label",xt,[e.tempOrder.is_paid?(o(),d("span",wt,"已付款")):(o(),d("span",Mt,"未付款"))])])])])])]),Ct])])],512),t("div",Dt,[t("div",Lt,[t("div",Pt,[Et,t("div",Vt,[O(" 是否刪除訂單編號 "),t("strong",Tt,l(e.tempOrder.id),1),O(" (刪除後將無法恢復)。 ")]),t("div",It,[Ut,t("button",{type:"button",class:"btn btn-danger",onClick:a[1]||(a[1]=(...s)=>i.delOrder&&i.delOrder(...s))}," 確認刪除 ")])])])],512)],64)}const qt=L(V,[["render",St]]);export{qt as default};
